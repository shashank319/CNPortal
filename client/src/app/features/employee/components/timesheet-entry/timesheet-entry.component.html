<!-- timesheet-entry.component.html -->
<div class="timesheet-entry-container">
  <!-- Header -->
  <div class="header">
    <h1>Timesheet Entry</h1>
    <div class="user-info">
      <div class="notification-dot"></div>
      <div class="user-avatar">
        <mat-icon>person</mat-icon>
      </div>
    </div>
  </div>

  <!-- Form Controls -->
  <form [formGroup]="timesheetForm" class="timesheet-form">
    <div class="controls-bar">
      <div class="form-controls">
        <div class="control-group">
          <label>Time Period</label>
          <mat-select formControlName="periodType" class="custom-select">
            <mat-option *ngFor="let period of periodTypes" [value]="period.value">
              {{ period.label }}
            </mat-option>
          </mat-select>
        </div>

        <div class="control-group">
          <label>Month</label>
          <div class="month-year-group">
            <mat-select formControlName="month" class="custom-select">
              <mat-option *ngFor="let month of months" [value]="month.value">
                {{ month.label }}
              </mat-option>
            </mat-select>
            <mat-select formControlName="year" class="custom-select year-select">
              <mat-option *ngFor="let year of years" [value]="year.value">
                {{ year.label }}
              </mat-option>
            </mat-select>

             <button type="button" 
                class="action-btn secondary"
                (click)="autoFill8Hours()"
                [disabled]="isSaving">
             <mat-icon>edit</mat-icon>
              Auto-Fill 8h/day
             </button>
          </div>
        </div>
      </div>

      <div class="total-hours-display">
        <span class="total-label">Total Hours:</span>
        <span class="total-value">{{ totalHours }}</span>
      </div>
    </div>

    <!-- Calendar Grid -->
    <div class="calendar-container" *ngIf="!isLoading && calendarDays.length > 0">
      <!-- Weekly View -->
      <div *ngIf="timesheetForm.get('periodType')?.value === 1" class="calendar-grid weekly">
        <div *ngFor="let day of calendarDays; let i = index; trackBy: trackByDate" class="day-cell">
          <div class="day-header">
            <span class="day-name">{{ day.dayName }}</span>
            <span class="day-date">{{ day.dayNumber }}</span>
          </div>
          <input type="number"
                 class="hours-input"
                 [class.filled]="day.hours > 0"
                 [class.weekend]="day.isWeekend"
                 min="0"
                 max="24"
                 step="0.5"
                 [value]="day.hours"
                 (input)="onHoursChange(i, $event)"
                 placeholder="0">
        </div>
      </div>

      <!-- Bi-Weekly View -->
      <div *ngIf="timesheetForm.get('periodType')?.value === 2" class="calendar-grid biweekly">
        <div *ngFor="let day of calendarDays; let i = index; trackBy: trackByDate" class="day-cell">
          <div class="day-header">
            <span class="day-name">{{ day.dayName }}</span>
            <span class="day-date">{{ day.dayNumber }}</span>
          </div>
          <input type="number"
                 class="hours-input"
                 [class.filled]="day.hours > 0"
                 [class.weekend]="day.isWeekend"
                 min="0"
                 max="24"
                 step="0.5"
                 [value]="day.hours"
                 (input)="onHoursChange(i, $event)"
                 placeholder="0">
        </div>
      </div>

      <!-- Monthly View -->
      <div *ngIf="timesheetForm.get('periodType')?.value === 3" class="calendar-grid monthly">
        <div class="month-header">
          <div class="day-label">Sun</div>
          <div class="day-label">Mon</div>
          <div class="day-label">Tue</div>
          <div class="day-label">Wed</div>
          <div class="day-label">Thu</div>
          <div class="day-label">Fri</div>
          <div class="day-label">Sat</div>
        </div>
        <div class="month-days">
          <div *ngFor="let day of getMonthlyDaysWithPadding(); let i = index; trackBy: trackByMonthDay" 
               class="month-day-cell"
               [class.other-month]="!day || !day.isCurrentMonth">
            <ng-container *ngIf="day">
              <span class="month-day-number">{{ day.dayNumber }}</span>
              <input *ngIf="day.isCurrentMonth && getDayIndex(day) >= 0"
                     type="number"
                     class="hours-input small"
                     [class.filled]="day.hours > 0"
                     [class.weekend]="day.isWeekend"
                     min="0"
                     max="24"
                     step="0.5"
                     [value]="day.hours"
                     (input)="onHoursChange(getDayIndex(day), $event)"
                     placeholder="0">
            </ng-container>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading Spinner -->
    <div *ngIf="isLoading" class="loading-container">
      <mat-spinner></mat-spinner>
      <p>Loading timesheet...</p>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons" *ngIf="!isLoading">
      <div class="left-actions">
        <button type="button"
                class="action-btn secondary"
                (click)="clearAll()"
                [disabled]="isSaving">
          <mat-icon>clear</mat-icon>
          Clear All
        </button>
      </div>

      <div class="right-actions">
        <button type="button"
                class="action-btn ghost"
                (click)="saveDraft()"
                [disabled]="isSaving || timesheetForm.invalid">
          Save Draft
        </button>

        <button type="button"
                class="action-btn primary"
                (click)="submitTimesheet()"
                [disabled]="isSaving || timesheetForm.invalid || totalHours === 0">
          Submit Timesheet
        </button>
      </div>
    </div>
  </form>
</div>